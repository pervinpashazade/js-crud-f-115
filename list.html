<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tələbə listi</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
</head>

<body>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-9">
                <table class="table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Ad</th>
                            <th>Soyad</th>
                            <th>FIN</th>
                            <th>E-poçt</th>
                            <th>Telefon</th>
                            <th>Kurs</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- <tr>
                            <td>1</td>
                            <td>Mark</td>
                            <td>Otto</td>
                            <td>@mdo</td>
                        </tr> -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const table_body = document.querySelector("tbody")

        const str = localStorage.getItem("student_list")

        const student_list = JSON.parse(str)
        const course_list = JSON.parse(localStorage.getItem("course_list"))

        console.log(student_list);
        console.log(course_list);

        function removeItem(fin_param, btn_elem) {
            // console.log("fin_param", fin_param);
            // console.log("student_list", student_list);
            // console.log("filter result =>   ", student_list.filter(student => student.fin != fin_param));

            console.log("btn_elem", btn_elem);

            // const filtred_array = student_list.filter(student => student.fin != fin_param)
            // localStorage.setItem("student_list", JSON.stringify(filtred_array))
        }

        student_list.forEach((student, index) => {
            const tr = document.createElement("tr")
            const selected_course = course_list.find(course => course.id == student.course_id)

            const delete_btn = document.createElement("button")
            delete_btn.innerText = "Sil"
            delete_btn.classList.add("btn", "btn-danger", "btn-sm")
            delete_btn.addEventListener("click", function () {

                removeItem(student.fin, this)
            })
            // delete_btn.addEventListener("click", () => removeItem(student.fin))

            tr.innerHTML += `
                <td>${index + 1}</td>
                <td>${student.name}</td>
                <td>${student.surname}</td>
                <td>${student.fin}</td>
                <td>${student.email}</td>
                <td>${student.phone}</td>
                <td>${selected_course ? selected_course.name : "təyin edilməyib"}</td>
                <td class="delete_item"></td>
            `;

            tr.querySelector(".delete_item").append(delete_btn)

            table_body.append(tr)
        });
    </script>
</body>

</html>